### 2018 我如何写好代码

> 2017年, mentor提得最多的一句话就是技术复盘; 2018,  总结一下过去一年所学到的代码知识和编程规范, 希望在新的一年继续有很大的提高和开心的编码

#### 函数

1. 一个函数只做一件事情。

2. 函数的参数不能过多，三个以下最好, 如果过多的话，我们Teambition Core 代码里有一个创建动态的函数，大概长这样：

   ```javascript
   function createActivity (
       _creatorId,
       action,
       boundId,
       boundType,
       content,
       emitEvent,
       callback
       ) {
         do...
       }
   ```

   大概是因为参数太多了, 假设电脑屏幕不够大的话, 在编辑器中都不能一行展示完毕, 因此需要用多行来进行表示,  每一个参数都有他自己的概念, 不仅是阅读代码的人感觉很抽象, 使用这个方法的人学习成本也比较大。换一个方位思考, 需要我们传入这么多参数的原因，我想无非是一个函数干了很多事情, 我们应当把他拆分出来，像管道一样, 每一步需要用到的数据都一个方法接收和生成, 一步步逻辑清晰地流转下去，因此形式参数过多，这不是一个很好的编程规范。

3. 函数名应该尽量体现函数所做的事情，与①结合, 越具体越好(避免给阅读代码的人或后人挖坑),  我之前犯过的一个错误: 

   ```
   写一个解析Excel文件的功能, 我管它叫做parseExcel, 但我却在里面不仅仅做了解析Excel文件的操作, 并且额外对解析后的数据进行了format ,  实际上应该将解析后数据原本返回, 留给之后的函数去做, 各司其职才能更好协作
   ```

4. 参数名不能太抽象， 也以我们Teambition Core的代码为例，我们的代码中，有时候会出现

   ```javascript
   function xxx (req...) {
     
   }
   ```

   如果你正好也看到这里，那你一定会迷惑，`req`这个参数是干嘛的，难道是API传进来的`request`？ 那没问题啊,  `request`对象里面本身就包含了很多属性, 框架里面已经定义好的。 但是我会告诉你, 如果是API接收回来的参数，我们这样写肯定没问题,  但是伴随着代码方法的下沉, 我们代码在第二层或者第三层出现了这样的参数就不应该了, 如果抽象一点，大概是这么表示的

   ```javascript
   function API (req, res, next) {
     function do (req, xxx) {
       function xxx (req) {
         const xx = req.body.xxx
         use xx
       }
     }
   }
   ```

   那么现在你应该知道有多么痛苦了